<html>
<head></head>
<body>
Prevent cross site scripting with jsoup
<div>
<div>
<div>
<ul>
<li><h4>jsoup</h4></li>
<li>News</li>
<li>Bugs</li>
<li>Discussion</li>
<li>Download</li>
<li>API Reference</li>
<li>Cookbook</li>
<li>Try jsoup</li>
</ul>
</div>
</div>
<div>
jsoup » Cookbook » Cleaning HTML » Sanitize untrusted HTML (to prevent XSS)
</div>
<div>
<div>
<div>
<h1>Sanitize untrusted HTML (to prevent XSS)</h1>
<h2>Problem</h2>
<p><a name="word" href="#" onClick="return false;" id=0>You</a> <a name="word" href="#" onClick="return false;" id=1>want</a> <a name="word" href="#" onClick="return false;" id=2>to</a> <a name="word" href="#" onClick="return false;" id=3>allow</a> <a name="word" href="#" onClick="return false;" id=4>untrusted</a> <a name="word" href="#" onClick="return false;" id=5>users</a> <a name="word" href="#" onClick="return false;" id=6>to</a> <a name="word" href="#" onClick="return false;" id=7>supply</a> <a name="word" href="#" onClick="return false;" id=8>HTML</a> <a name="word" href="#" onClick="return false;" id=9>for</a> <a name="word" href="#" onClick="return false;" id=10>output</a> <a name="word" href="#" onClick="return false;" id=11>on</a> <a name="word" href="#" onClick="return false;" id=12>your</a> <a name="word" href="#" onClick="return false;" id=13>website</a> <a name="word" href="#" onClick="return false;" id=14>(e.g.</a> <a name="word" href="#" onClick="return false;" id=15>as</a> <a name="word" href="#" onClick="return false;" id=16>comment</a> <a name="word" href="#" onClick="return false;" id=17>submission).</a> <a name="word" href="#" onClick="return false;" id=18>You</a> <a name="word" href="#" onClick="return false;" id=19>need</a> <a name="word" href="#" onClick="return false;" id=20>to</a> <a name="word" href="#" onClick="return false;" id=21>clean</a> <a name="word" href="#" onClick="return false;" id=22>this</a> <a name="word" href="#" onClick="return false;" id=23>HTML</a> <a name="word" href="#" onClick="return false;" id=24>to</a> <a name="word" href="#" onClick="return false;" id=25>avoid</a> <a name="word" href="#" onClick="return false;" id=26>cross-site</a> <a name="word" href="#" onClick="return false;" id=27>scripting</a> <a name="word" href="#" onClick="return false;" id=28>(XSS)</a> <a name="word" href="#" onClick="return false;" id=29>attacks.</a> </p>
<h2>Solution</h2>
<p><a name="word" href="#" onClick="return false;" id=30>Use</a> <a name="word" href="#" onClick="return false;" id=31>the</a> <a name="word" href="#" onClick="return false;" id=32>jsoup</a> <a name="word" href="#" onClick="return false;" id=33>HTML</a> <a name="word" href="#" onClick="return false;" id=34>Cleaner</a> <a name="word" href="#" onClick="return false;" id=35>with</a> <a name="word" href="#" onClick="return false;" id=36>a</a> <a name="word" href="#" onClick="return false;" id=37>configuration</a> <a name="word" href="#" onClick="return false;" id=38>specified</a> <a name="word" href="#" onClick="return false;" id=39>by</a> <a name="word" href="#" onClick="return false;" id=40>a</a> <a name="word" href="#" onClick="return false;" id=41>Safelist.</a> </p>
<code>String unsafe = "<p><a href='http://example.com/' onclick='stealCookies()'>Link</a></p>"; String safe = Jsoup.clean(unsafe, Safelist.basic()); // now: <p><a href="http://example.com/" rel="nofollow">Link</a></p> </code>
<h2>Discussion</h2>
<p><a name="word" href="#" onClick="return false;" id=42>A</a> <a name="word" href="#" onClick="return false;" id=43>cross-site</a> <a name="word" href="#" onClick="return false;" id=44>scripting</a> <a name="word" href="#" onClick="return false;" id=45>attack</a> <a name="word" href="#" onClick="return false;" id=46>against</a> <a name="word" href="#" onClick="return false;" id=47>your</a> <a name="word" href="#" onClick="return false;" id=48>site</a> <a name="word" href="#" onClick="return false;" id=49>can</a> <a name="word" href="#" onClick="return false;" id=50>really</a> <a name="word" href="#" onClick="return false;" id=51>ruin</a> <a name="word" href="#" onClick="return false;" id=52>your</a> <a name="word" href="#" onClick="return false;" id=53>day,</a> <a name="word" href="#" onClick="return false;" id=54>not</a> <a name="word" href="#" onClick="return false;" id=55>to</a> <a name="word" href="#" onClick="return false;" id=56>mention</a> <a name="word" href="#" onClick="return false;" id=57>your</a> <a name="word" href="#" onClick="return false;" id=58>users'.</a> <a name="word" href="#" onClick="return false;" id=59>Many</a> <a name="word" href="#" onClick="return false;" id=60>sites</a> <a name="word" href="#" onClick="return false;" id=61>avoid</a> <a name="word" href="#" onClick="return false;" id=62>XSS</a> <a name="word" href="#" onClick="return false;" id=63>attacks</a> <a name="word" href="#" onClick="return false;" id=64>by</a> <a name="word" href="#" onClick="return false;" id=65>not</a> <a name="word" href="#" onClick="return false;" id=66>allowing</a> <a name="word" href="#" onClick="return false;" id=67>HTML</a> <a name="word" href="#" onClick="return false;" id=68>in</a> <a name="word" href="#" onClick="return false;" id=69>user</a> <a name="word" href="#" onClick="return false;" id=70>submitted</a> <a name="word" href="#" onClick="return false;" id=71>content:</a> <a name="word" href="#" onClick="return false;" id=72>they</a> <a name="word" href="#" onClick="return false;" id=73>enforce</a> <a name="word" href="#" onClick="return false;" id=74>plain</a> <a name="word" href="#" onClick="return false;" id=75>text</a> <a name="word" href="#" onClick="return false;" id=76>only,</a> <a name="word" href="#" onClick="return false;" id=77>or</a> <a name="word" href="#" onClick="return false;" id=78>use</a> <a name="word" href="#" onClick="return false;" id=79>an</a> <a name="word" href="#" onClick="return false;" id=80>alternative</a> <a name="word" href="#" onClick="return false;" id=81>markup</a> <a name="word" href="#" onClick="return false;" id=82>syntax</a> <a name="word" href="#" onClick="return false;" id=83>like</a> <a name="word" href="#" onClick="return false;" id=84>wiki-text</a> <a name="word" href="#" onClick="return false;" id=85>or</a> <a name="word" href="#" onClick="return false;" id=86>Markdown.</a> <a name="word" href="#" onClick="return false;" id=87>These</a> <a name="word" href="#" onClick="return false;" id=88>are</a> <a name="word" href="#" onClick="return false;" id=89>seldom</a> <a name="word" href="#" onClick="return false;" id=90>optimal</a> <a name="word" href="#" onClick="return false;" id=91>solutions</a> <a name="word" href="#" onClick="return false;" id=92>for</a> <a name="word" href="#" onClick="return false;" id=93>the</a> <a name="word" href="#" onClick="return false;" id=94>user,</a> <a name="word" href="#" onClick="return false;" id=95>as</a> <a name="word" href="#" onClick="return false;" id=96>they</a> <a name="word" href="#" onClick="return false;" id=97>lower</a> <a name="word" href="#" onClick="return false;" id=98>expressiveness,</a> <a name="word" href="#" onClick="return false;" id=99>and</a> <a name="word" href="#" onClick="return false;" id=100>force</a> <a name="word" href="#" onClick="return false;" id=101>the</a> <a name="word" href="#" onClick="return false;" id=102>user</a> <a name="word" href="#" onClick="return false;" id=103>to</a> <a name="word" href="#" onClick="return false;" id=104>learn</a> <a name="word" href="#" onClick="return false;" id=105>a</a> <a name="word" href="#" onClick="return false;" id=106>new</a> <a name="word" href="#" onClick="return false;" id=107>syntax.</a> </p>
<p><a name="word" href="#" onClick="return false;" id=108>A</a> <a name="word" href="#" onClick="return false;" id=109>better</a> <a name="word" href="#" onClick="return false;" id=110>solution</a> <a name="word" href="#" onClick="return false;" id=111>may</a> <a name="word" href="#" onClick="return false;" id=112>be</a> <a name="word" href="#" onClick="return false;" id=113>to</a> <a name="word" href="#" onClick="return false;" id=114>use</a> <a name="word" href="#" onClick="return false;" id=115>a</a> <a name="word" href="#" onClick="return false;" id=116>rich</a> <a name="word" href="#" onClick="return false;" id=117>text</a> <a name="word" href="#" onClick="return false;" id=118>WYSIWYG</a> <a name="word" href="#" onClick="return false;" id=119>editor</a> <a name="word" href="#" onClick="return false;" id=120>(like</a> <a name="word" href="#" onClick="return false;" id=121>CKEditor</a> <a name="word" href="#" onClick="return false;" id=122>or</a> <a name="word" href="#" onClick="return false;" id=123>TinyMCE).</a> <a name="word" href="#" onClick="return false;" id=124>These</a> <a name="word" href="#" onClick="return false;" id=125>output</a> <a name="word" href="#" onClick="return false;" id=126>HTML,</a> <a name="word" href="#" onClick="return false;" id=127>and</a> <a name="word" href="#" onClick="return false;" id=128>allow</a> <a name="word" href="#" onClick="return false;" id=129>the</a> <a name="word" href="#" onClick="return false;" id=130>user</a> <a name="word" href="#" onClick="return false;" id=131>to</a> <a name="word" href="#" onClick="return false;" id=132>work</a> <a name="word" href="#" onClick="return false;" id=133>visually.</a> <a name="word" href="#" onClick="return false;" id=134>However,</a> <a name="word" href="#" onClick="return false;" id=135>their</a> <a name="word" href="#" onClick="return false;" id=136>validation</a> <a name="word" href="#" onClick="return false;" id=137>is</a> <a name="word" href="#" onClick="return false;" id=138>done</a> <a name="word" href="#" onClick="return false;" id=139>on</a> <a name="word" href="#" onClick="return false;" id=140>the</a> <a name="word" href="#" onClick="return false;" id=141>client</a> <a name="word" href="#" onClick="return false;" id=142>side:</a> <a name="word" href="#" onClick="return false;" id=143>you</a> <a name="word" href="#" onClick="return false;" id=144>need</a> <a name="word" href="#" onClick="return false;" id=145>to</a> <a name="word" href="#" onClick="return false;" id=146>apply</a> <a name="word" href="#" onClick="return false;" id=147>a</a> <a name="word" href="#" onClick="return false;" id=148>server-side</a> <a name="word" href="#" onClick="return false;" id=149>validation</a> <a name="word" href="#" onClick="return false;" id=150>to</a> <a name="word" href="#" onClick="return false;" id=151>clean</a> <a name="word" href="#" onClick="return false;" id=152>up</a> <a name="word" href="#" onClick="return false;" id=153>the</a> <a name="word" href="#" onClick="return false;" id=154>input</a> <a name="word" href="#" onClick="return false;" id=155>and</a> <a name="word" href="#" onClick="return false;" id=156>ensure</a> <a name="word" href="#" onClick="return false;" id=157>the</a> <a name="word" href="#" onClick="return false;" id=158>HTML</a> <a name="word" href="#" onClick="return false;" id=159>is</a> <a name="word" href="#" onClick="return false;" id=160>safe</a> <a name="word" href="#" onClick="return false;" id=161>to</a> <a name="word" href="#" onClick="return false;" id=162>place</a> <a name="word" href="#" onClick="return false;" id=163>on</a> <a name="word" href="#" onClick="return false;" id=164>your</a> <a name="word" href="#" onClick="return false;" id=165>site.</a> <a name="word" href="#" onClick="return false;" id=166>Otherwise,</a> <a name="word" href="#" onClick="return false;" id=167>an</a> <a name="word" href="#" onClick="return false;" id=168>attacker</a> <a name="word" href="#" onClick="return false;" id=169>can</a> <a name="word" href="#" onClick="return false;" id=170>avoid</a> <a name="word" href="#" onClick="return false;" id=171>the</a> <a name="word" href="#" onClick="return false;" id=172>client-side</a> <a name="word" href="#" onClick="return false;" id=173>Javascript</a> <a name="word" href="#" onClick="return false;" id=174>validation</a> <a name="word" href="#" onClick="return false;" id=175>and</a> <a name="word" href="#" onClick="return false;" id=176>inject</a> <a name="word" href="#" onClick="return false;" id=177>unsafe</a> <a name="word" href="#" onClick="return false;" id=178>HMTL</a> <a name="word" href="#" onClick="return false;" id=179>directly</a> <a name="word" href="#" onClick="return false;" id=180>into</a> <a name="word" href="#" onClick="return false;" id=181>your</a> <a name="word" href="#" onClick="return false;" id=182>site</a> </p>
<p><a name="word" href="#" onClick="return false;" id=183>The</a> <a name="word" href="#" onClick="return false;" id=184>jsoup</a> <a name="word" href="#" onClick="return false;" id=185>safelist</a> <a name="word" href="#" onClick="return false;" id=186>sanitizer</a> <a name="word" href="#" onClick="return false;" id=187>works</a> <a name="word" href="#" onClick="return false;" id=188>by</a> <a name="word" href="#" onClick="return false;" id=189>parsing</a> <a name="word" href="#" onClick="return false;" id=190>the</a> <a name="word" href="#" onClick="return false;" id=191>input</a> <a name="word" href="#" onClick="return false;" id=192>HTML</a> <a name="word" href="#" onClick="return false;" id=193>(in</a> <a name="word" href="#" onClick="return false;" id=194>a</a> <a name="word" href="#" onClick="return false;" id=195>safe,</a> <a name="word" href="#" onClick="return false;" id=196>sand-boxed</a> <a name="word" href="#" onClick="return false;" id=197>environment),</a> <a name="word" href="#" onClick="return false;" id=198>and</a> <a name="word" href="#" onClick="return false;" id=199>then</a> <a name="word" href="#" onClick="return false;" id=200>iterating</a> <a name="word" href="#" onClick="return false;" id=201>through</a> <a name="word" href="#" onClick="return false;" id=202>the</a> <a name="word" href="#" onClick="return false;" id=203>parse</a> <a name="word" href="#" onClick="return false;" id=204>tree</a> <a name="word" href="#" onClick="return false;" id=205>and</a> <a name="word" href="#" onClick="return false;" id=206>only</a> <a name="word" href="#" onClick="return false;" id=207>allowing</a> <a name="word" href="#" onClick="return false;" id=208>known-safe</a> <a name="word" href="#" onClick="return false;" id=209>tags</a> <a name="word" href="#" onClick="return false;" id=210>and</a> <a name="word" href="#" onClick="return false;" id=211>attributes</a> <a name="word" href="#" onClick="return false;" id=212>(and</a> <a name="word" href="#" onClick="return false;" id=213>values)</a> <a name="word" href="#" onClick="return false;" id=214>through</a> <a name="word" href="#" onClick="return false;" id=215>into</a> <a name="word" href="#" onClick="return false;" id=216>the</a> <a name="word" href="#" onClick="return false;" id=217>cleaned</a> <a name="word" href="#" onClick="return false;" id=218>output.</a> </p>
<p><a name="word" href="#" onClick="return false;" id=219>It</a> <a name="word" href="#" onClick="return false;" id=220>does</a> <a name="word" href="#" onClick="return false;" id=221>not</a> <a name="word" href="#" onClick="return false;" id=222>use</a> <a name="word" href="#" onClick="return false;" id=223>regular</a> <a name="word" href="#" onClick="return false;" id=224>expressions,</a> <a name="word" href="#" onClick="return false;" id=225>which</a> <a name="word" href="#" onClick="return false;" id=226>are</a> <a name="word" href="#" onClick="return false;" id=227>inappropriate</a> <a name="word" href="#" onClick="return false;" id=228>for</a> <a name="word" href="#" onClick="return false;" id=229>this</a> <a name="word" href="#" onClick="return false;" id=230>task.</a> </p>
<p><a name="word" href="#" onClick="return false;" id=231>jsoup</a> <a name="word" href="#" onClick="return false;" id=232>provides</a> <a name="word" href="#" onClick="return false;" id=233>a</a> <a name="word" href="#" onClick="return false;" id=234>range</a> <a name="word" href="#" onClick="return false;" id=235>of</a> <a name="word" href="#" onClick="return false;" id=236>Safelist</a> <a name="word" href="#" onClick="return false;" id=237>configurations</a> <a name="word" href="#" onClick="return false;" id=238>to</a> <a name="word" href="#" onClick="return false;" id=239>suit</a> <a name="word" href="#" onClick="return false;" id=240>most</a> <a name="word" href="#" onClick="return false;" id=241>requirements;</a> <a name="word" href="#" onClick="return false;" id=242>they</a> <a name="word" href="#" onClick="return false;" id=243>can</a> <a name="word" href="#" onClick="return false;" id=244>be</a> <a name="word" href="#" onClick="return false;" id=245>modified</a> <a name="word" href="#" onClick="return false;" id=246>if</a> <a name="word" href="#" onClick="return false;" id=247>necessary,</a> <a name="word" href="#" onClick="return false;" id=248>but</a> <a name="word" href="#" onClick="return false;" id=249>take</a> <a name="word" href="#" onClick="return false;" id=250>care.</a> </p>
<p><a name="word" href="#" onClick="return false;" id=251>The</a> <a name="word" href="#" onClick="return false;" id=252>cleaner</a> <a name="word" href="#" onClick="return false;" id=253>is</a> <a name="word" href="#" onClick="return false;" id=254>useful</a> <a name="word" href="#" onClick="return false;" id=255>not</a> <a name="word" href="#" onClick="return false;" id=256>only</a> <a name="word" href="#" onClick="return false;" id=257>for</a> <a name="word" href="#" onClick="return false;" id=258>avoiding</a> <a name="word" href="#" onClick="return false;" id=259>XSS,</a> <a name="word" href="#" onClick="return false;" id=260>but</a> <a name="word" href="#" onClick="return false;" id=261>also</a> <a name="word" href="#" onClick="return false;" id=262>in</a> <a name="word" href="#" onClick="return false;" id=263>limiting</a> <a name="word" href="#" onClick="return false;" id=264>the</a> <a name="word" href="#" onClick="return false;" id=265>range</a> <a name="word" href="#" onClick="return false;" id=266>of</a> <a name="word" href="#" onClick="return false;" id=267>elements</a> <a name="word" href="#" onClick="return false;" id=268>the</a> <a name="word" href="#" onClick="return false;" id=269>user</a> <a name="word" href="#" onClick="return false;" id=270>can</a> <a name="word" href="#" onClick="return false;" id=271>provide:</a> <a name="word" href="#" onClick="return false;" id=272>you</a> <a name="word" href="#" onClick="return false;" id=273>may</a> <a name="word" href="#" onClick="return false;" id=274>be</a> <a name="word" href="#" onClick="return false;" id=275>OK</a> <a name="word" href="#" onClick="return false;" id=276>with</a> <a name="word" href="#" onClick="return false;" id=277>textual</a> <a name="word" href="#" onClick="return false;" id=278>a,</a> <a name="word" href="#" onClick="return false;" id=279>strong</a> <a name="word" href="#" onClick="return false;" id=280>elements,</a> <a name="word" href="#" onClick="return false;" id=281>but</a> <a name="word" href="#" onClick="return false;" id=282>not</a> <a name="word" href="#" onClick="return false;" id=283>structural</a> <a name="word" href="#" onClick="return false;" id=284>div</a> <a name="word" href="#" onClick="return false;" id=285>or</a> <a name="word" href="#" onClick="return false;" id=286>table</a> <a name="word" href="#" onClick="return false;" id=287>elements.</a> </p>
<h2>See also</h2>
<ul>
<li>See the XSS cheat sheet and filter evasion guide, as an example of how regular-expression filters don't work, and why a safe safelist parser-based sanitizer is the correct approach.</li>
<li>See the <code>Cleaner</code> reference if you want to get a <code>Document</code> instead of a String return</li>
<li>See the <code>Safelist</code> reference for the different canned options, and to create a custom safelist</li>
<li>The nofollow link attribute</li>
</ul>
</div>
</div>
<div>
<div>
<h2>Cookbook contents</h2>
<h3>Introduction</h3>
<li>Parsing and traversing a Document</li>
<h3>Input</h3>
<li>Parse a document from a String</li>
<li>Parsing a body fragment</li>
<li>Load a Document from a URL</li>
<li>Load a Document from a File</li>
<h3>Extracting data</h3>
<li>Use DOM methods to navigate a document</li>
<li>Use selector-syntax to find elements</li>
<li>Extract attributes, text, and HTML from elements</li>
<li>Working with URLs</li>
<li>Example program: list links</li>
<h3>Modifying data</h3>
<li>Set attribute values</li>
<li>Set the HTML of an element</li>
<li>Setting the text content of elements</li>
<h3>Cleaning HTML</h3>
<li>Sanitize untrusted HTML (to prevent XSS)</li>
</div>
</div>
</div>
<div>
jsoup HTML parser © 2009 - 2021 Jonathan Hedley
</div>
</div>
</body>
</html>