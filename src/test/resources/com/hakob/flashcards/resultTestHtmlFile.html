<html>
 <head></head>
 <body>
  Prevent cross site scripting with jsoup
  <div>
   <div>
    <div>
     <ul>
      <li><h4>jsoup</h4></li>
      <li>News</li>
      <li>Bugs</li>
      <li>Discussion</li>
      <li>Download</li>
      <li>API Reference</li>
      <li>Cookbook</li>
      <li>Try jsoup</li>
     </ul>
    </div>
   </div>
   <div>
     jsoup » Cookbook » Cleaning HTML » Sanitize untrusted HTML (to prevent XSS)
   </div>
   <div>
    <div>
     <div>
      <h1>Sanitize untrusted HTML (to prevent XSS)</h1>
      <h2>Problem</h2>
      <p><a name="word" href="#" onClick="return false;" id=0>You</a> <a name="word" href="#" onClick="return false;" id=0>want</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>allow</a> <a name="word" href="#" onClick="return false;" id=0>untrusted</a> <a name="word" href="#" onClick="return false;" id=0>users</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>supply</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>for</a> <a name="word" href="#" onClick="return false;" id=0>output</a> <a name="word" href="#" onClick="return false;" id=0>on</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>website</a> <a name="word" href="#" onClick="return false;" id=0>(e.g.</a> <a name="word" href="#" onClick="return false;" id=0>as</a> <a name="word" href="#" onClick="return false;" id=0>comment</a> <a name="word" href="#" onClick="return false;" id=0>submission).</a> <a name="word" href="#" onClick="return false;" id=0>You</a> <a name="word" href="#" onClick="return false;" id=0>need</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>clean</a> <a name="word" href="#" onClick="return false;" id=0>this</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>avoid</a> <a name="word" href="#" onClick="return false;" id=0>cross-site</a> <a name="word" href="#" onClick="return false;" id=0>scripting</a> <a name="word" href="#" onClick="return false;" id=0>(XSS)</a> <a name="word" href="#" onClick="return false;" id=0>attacks.</a> </p>
      <h2>Solution</h2>
      <p><a name="word" href="#" onClick="return false;" id=0>Use</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>jsoup</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>Cleaner</a> <a name="word" href="#" onClick="return false;" id=0>with</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>configuration</a> <a name="word" href="#" onClick="return false;" id=0>specified</a> <a name="word" href="#" onClick="return false;" id=0>by</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>Safelist.</a> </p>
      <code>String unsafe = "<p><a href='http://example.com/' onclick='stealCookies()'>Link</a></p>"; String safe = Jsoup.clean(unsafe, Safelist.basic()); // now: <p><a href="http://example.com/" rel="nofollow">Link</a></p> </code>
      <h2>Discussion</h2>
      <p><a name="word" href="#" onClick="return false;" id=0>A</a> <a name="word" href="#" onClick="return false;" id=0>cross-site</a> <a name="word" href="#" onClick="return false;" id=0>scripting</a> <a name="word" href="#" onClick="return false;" id=0>attack</a> <a name="word" href="#" onClick="return false;" id=0>against</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>site</a> <a name="word" href="#" onClick="return false;" id=0>can</a> <a name="word" href="#" onClick="return false;" id=0>really</a> <a name="word" href="#" onClick="return false;" id=0>ruin</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>day,</a> <a name="word" href="#" onClick="return false;" id=0>not</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>mention</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>users'.</a> <a name="word" href="#" onClick="return false;" id=0>Many</a> <a name="word" href="#" onClick="return false;" id=0>sites</a> <a name="word" href="#" onClick="return false;" id=0>avoid</a> <a name="word" href="#" onClick="return false;" id=0>XSS</a> <a name="word" href="#" onClick="return false;" id=0>attacks</a> <a name="word" href="#" onClick="return false;" id=0>by</a> <a name="word" href="#" onClick="return false;" id=0>not</a> <a name="word" href="#" onClick="return false;" id=0>allowing</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>in</a> <a name="word" href="#" onClick="return false;" id=0>user</a> <a name="word" href="#" onClick="return false;" id=0>submitted</a> <a name="word" href="#" onClick="return false;" id=0>content:</a> <a name="word" href="#" onClick="return false;" id=0>they</a> <a name="word" href="#" onClick="return false;" id=0>enforce</a> <a name="word" href="#" onClick="return false;" id=0>plain</a> <a name="word" href="#" onClick="return false;" id=0>text</a> <a name="word" href="#" onClick="return false;" id=0>only,</a> <a name="word" href="#" onClick="return false;" id=0>or</a> <a name="word" href="#" onClick="return false;" id=0>use</a> <a name="word" href="#" onClick="return false;" id=0>an</a> <a name="word" href="#" onClick="return false;" id=0>alternative</a> <a name="word" href="#" onClick="return false;" id=0>markup</a> <a name="word" href="#" onClick="return false;" id=0>syntax</a> <a name="word" href="#" onClick="return false;" id=0>like</a> <a name="word" href="#" onClick="return false;" id=0>wiki-text</a> <a name="word" href="#" onClick="return false;" id=0>or</a> <a name="word" href="#" onClick="return false;" id=0>Markdown.</a> <a name="word" href="#" onClick="return false;" id=0>These</a> <a name="word" href="#" onClick="return false;" id=0>are</a> <a name="word" href="#" onClick="return false;" id=0>seldom</a> <a name="word" href="#" onClick="return false;" id=0>optimal</a> <a name="word" href="#" onClick="return false;" id=0>solutions</a> <a name="word" href="#" onClick="return false;" id=0>for</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>user,</a> <a name="word" href="#" onClick="return false;" id=0>as</a> <a name="word" href="#" onClick="return false;" id=0>they</a> <a name="word" href="#" onClick="return false;" id=0>lower</a> <a name="word" href="#" onClick="return false;" id=0>expressiveness,</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>force</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>user</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>learn</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>new</a> <a name="word" href="#" onClick="return false;" id=0>syntax.</a> </p>
      <p><a name="word" href="#" onClick="return false;" id=0>A</a> <a name="word" href="#" onClick="return false;" id=0>better</a> <a name="word" href="#" onClick="return false;" id=0>solution</a> <a name="word" href="#" onClick="return false;" id=0>may</a> <a name="word" href="#" onClick="return false;" id=0>be</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>use</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>rich</a> <a name="word" href="#" onClick="return false;" id=0>text</a> <a name="word" href="#" onClick="return false;" id=0>WYSIWYG</a> <a name="word" href="#" onClick="return false;" id=0>editor</a> <a name="word" href="#" onClick="return false;" id=0>(like</a> <a name="word" href="#" onClick="return false;" id=0>CKEditor</a> <a name="word" href="#" onClick="return false;" id=0>or</a> <a name="word" href="#" onClick="return false;" id=0>TinyMCE).</a> <a name="word" href="#" onClick="return false;" id=0>These</a> <a name="word" href="#" onClick="return false;" id=0>output</a> <a name="word" href="#" onClick="return false;" id=0>HTML,</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>allow</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>user</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>work</a> <a name="word" href="#" onClick="return false;" id=0>visually.</a> <a name="word" href="#" onClick="return false;" id=0>However,</a> <a name="word" href="#" onClick="return false;" id=0>their</a> <a name="word" href="#" onClick="return false;" id=0>validation</a> <a name="word" href="#" onClick="return false;" id=0>is</a> <a name="word" href="#" onClick="return false;" id=0>done</a> <a name="word" href="#" onClick="return false;" id=0>on</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>client</a> <a name="word" href="#" onClick="return false;" id=0>side:</a> <a name="word" href="#" onClick="return false;" id=0>you</a> <a name="word" href="#" onClick="return false;" id=0>need</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>apply</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>server-side</a> <a name="word" href="#" onClick="return false;" id=0>validation</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>clean</a> <a name="word" href="#" onClick="return false;" id=0>up</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>input</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>ensure</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>is</a> <a name="word" href="#" onClick="return false;" id=0>safe</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>place</a> <a name="word" href="#" onClick="return false;" id=0>on</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>site.</a> <a name="word" href="#" onClick="return false;" id=0>Otherwise,</a> <a name="word" href="#" onClick="return false;" id=0>an</a> <a name="word" href="#" onClick="return false;" id=0>attacker</a> <a name="word" href="#" onClick="return false;" id=0>can</a> <a name="word" href="#" onClick="return false;" id=0>avoid</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>client-side</a> <a name="word" href="#" onClick="return false;" id=0>Javascript</a> <a name="word" href="#" onClick="return false;" id=0>validation</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>inject</a> <a name="word" href="#" onClick="return false;" id=0>unsafe</a> <a name="word" href="#" onClick="return false;" id=0>HMTL</a> <a name="word" href="#" onClick="return false;" id=0>directly</a> <a name="word" href="#" onClick="return false;" id=0>into</a> <a name="word" href="#" onClick="return false;" id=0>your</a> <a name="word" href="#" onClick="return false;" id=0>site</a> </p>
      <p><a name="word" href="#" onClick="return false;" id=0>The</a> <a name="word" href="#" onClick="return false;" id=0>jsoup</a> <a name="word" href="#" onClick="return false;" id=0>safelist</a> <a name="word" href="#" onClick="return false;" id=0>sanitizer</a> <a name="word" href="#" onClick="return false;" id=0>works</a> <a name="word" href="#" onClick="return false;" id=0>by</a> <a name="word" href="#" onClick="return false;" id=0>parsing</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>input</a> <a name="word" href="#" onClick="return false;" id=0>HTML</a> <a name="word" href="#" onClick="return false;" id=0>(in</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>safe,</a> <a name="word" href="#" onClick="return false;" id=0>sand-boxed</a> <a name="word" href="#" onClick="return false;" id=0>environment),</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>then</a> <a name="word" href="#" onClick="return false;" id=0>iterating</a> <a name="word" href="#" onClick="return false;" id=0>through</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>parse</a> <a name="word" href="#" onClick="return false;" id=0>tree</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>only</a> <a name="word" href="#" onClick="return false;" id=0>allowing</a> <a name="word" href="#" onClick="return false;" id=0>known-safe</a> <a name="word" href="#" onClick="return false;" id=0>tags</a> <a name="word" href="#" onClick="return false;" id=0>and</a> <a name="word" href="#" onClick="return false;" id=0>attributes</a> <a name="word" href="#" onClick="return false;" id=0>(and</a> <a name="word" href="#" onClick="return false;" id=0>values)</a> <a name="word" href="#" onClick="return false;" id=0>through</a> <a name="word" href="#" onClick="return false;" id=0>into</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>cleaned</a> <a name="word" href="#" onClick="return false;" id=0>output.</a> </p>
      <p><a name="word" href="#" onClick="return false;" id=0>It</a> <a name="word" href="#" onClick="return false;" id=0>does</a> <a name="word" href="#" onClick="return false;" id=0>not</a> <a name="word" href="#" onClick="return false;" id=0>use</a> <a name="word" href="#" onClick="return false;" id=0>regular</a> <a name="word" href="#" onClick="return false;" id=0>expressions,</a> <a name="word" href="#" onClick="return false;" id=0>which</a> <a name="word" href="#" onClick="return false;" id=0>are</a> <a name="word" href="#" onClick="return false;" id=0>inappropriate</a> <a name="word" href="#" onClick="return false;" id=0>for</a> <a name="word" href="#" onClick="return false;" id=0>this</a> <a name="word" href="#" onClick="return false;" id=0>task.</a> </p>
      <p><a name="word" href="#" onClick="return false;" id=0>jsoup</a> <a name="word" href="#" onClick="return false;" id=0>provides</a> <a name="word" href="#" onClick="return false;" id=0>a</a> <a name="word" href="#" onClick="return false;" id=0>range</a> <a name="word" href="#" onClick="return false;" id=0>of</a> <a name="word" href="#" onClick="return false;" id=0>Safelist</a> <a name="word" href="#" onClick="return false;" id=0>configurations</a> <a name="word" href="#" onClick="return false;" id=0>to</a> <a name="word" href="#" onClick="return false;" id=0>suit</a> <a name="word" href="#" onClick="return false;" id=0>most</a> <a name="word" href="#" onClick="return false;" id=0>requirements;</a> <a name="word" href="#" onClick="return false;" id=0>they</a> <a name="word" href="#" onClick="return false;" id=0>can</a> <a name="word" href="#" onClick="return false;" id=0>be</a> <a name="word" href="#" onClick="return false;" id=0>modified</a> <a name="word" href="#" onClick="return false;" id=0>if</a> <a name="word" href="#" onClick="return false;" id=0>necessary,</a> <a name="word" href="#" onClick="return false;" id=0>but</a> <a name="word" href="#" onClick="return false;" id=0>take</a> <a name="word" href="#" onClick="return false;" id=0>care.</a> </p>
      <p><a name="word" href="#" onClick="return false;" id=0>The</a> <a name="word" href="#" onClick="return false;" id=0>cleaner</a> <a name="word" href="#" onClick="return false;" id=0>is</a> <a name="word" href="#" onClick="return false;" id=0>useful</a> <a name="word" href="#" onClick="return false;" id=0>not</a> <a name="word" href="#" onClick="return false;" id=0>only</a> <a name="word" href="#" onClick="return false;" id=0>for</a> <a name="word" href="#" onClick="return false;" id=0>avoiding</a> <a name="word" href="#" onClick="return false;" id=0>XSS,</a> <a name="word" href="#" onClick="return false;" id=0>but</a> <a name="word" href="#" onClick="return false;" id=0>also</a> <a name="word" href="#" onClick="return false;" id=0>in</a> <a name="word" href="#" onClick="return false;" id=0>limiting</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>range</a> <a name="word" href="#" onClick="return false;" id=0>of</a> <a name="word" href="#" onClick="return false;" id=0>elements</a> <a name="word" href="#" onClick="return false;" id=0>the</a> <a name="word" href="#" onClick="return false;" id=0>user</a> <a name="word" href="#" onClick="return false;" id=0>can</a> <a name="word" href="#" onClick="return false;" id=0>provide:</a> <a name="word" href="#" onClick="return false;" id=0>you</a> <a name="word" href="#" onClick="return false;" id=0>may</a> <a name="word" href="#" onClick="return false;" id=0>be</a> <a name="word" href="#" onClick="return false;" id=0>OK</a> <a name="word" href="#" onClick="return false;" id=0>with</a> <a name="word" href="#" onClick="return false;" id=0>textual</a> <a name="word" href="#" onClick="return false;" id=0>a,</a> <a name="word" href="#" onClick="return false;" id=0>strong</a> <a name="word" href="#" onClick="return false;" id=0>elements,</a> <a name="word" href="#" onClick="return false;" id=0>but</a> <a name="word" href="#" onClick="return false;" id=0>not</a> <a name="word" href="#" onClick="return false;" id=0>structural</a> <a name="word" href="#" onClick="return false;" id=0>div</a> <a name="word" href="#" onClick="return false;" id=0>or</a> <a name="word" href="#" onClick="return false;" id=0>table</a> <a name="word" href="#" onClick="return false;" id=0>elements.</a> </p>
      <h2>See also</h2>
      <ul>
       <li>See the XSS cheat sheet and filter evasion guide, as an example of how regular-expression filters don't work, and why a safe safelist parser-based sanitizer is the correct approach.</li>
       <li>See the <code>Cleaner</code> reference if you want to get a <code>Document</code> instead of a String return</li>
       <li>See the <code>Safelist</code> reference for the different canned options, and to create a custom safelist</li>
       <li>The nofollow link attribute</li>
      </ul>
     </div>
    </div>
    <div>
     <div>
      <h2>Cookbook contents</h2>
      <h3>Introduction</h3>
      <li>Parsing and traversing a Document</li>
      <h3>Input</h3>
      <li>Parse a document from a String</li>
      <li>Parsing a body fragment</li>
      <li>Load a Document from a URL</li>
      <li>Load a Document from a File</li>
      <h3>Extracting data</h3>
      <li>Use DOM methods to navigate a document</li>
      <li>Use selector-syntax to find elements</li>
      <li>Extract attributes, text, and HTML from elements</li>
      <li>Working with URLs</li>
      <li>Example program: list links</li>
      <h3>Modifying data</h3>
      <li>Set attribute values</li>
      <li>Set the HTML of an element</li>
      <li>Setting the text content of elements</li>
      <h3>Cleaning HTML</h3>
      <li>Sanitize untrusted HTML (to prevent XSS)</li>
     </div>
    </div>
   </div>
   <div>
     jsoup HTML parser © 2009 - 2021 Jonathan Hedley
   </div>
  </div>
 </body>
</html>