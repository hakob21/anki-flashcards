<p>Prevent cross site scripting with jsoup</p>
<div>
    <div>
        <div>
            <ul>
                <li>
                    <h4>jsoup</h4>
                </li>
                <li>News</li>
                <li>Bugs</li>
                <li>Discussion</li>
                <li>Download</li>
                <li>API Reference</li>
                <li>Cookbook</li>
                <li>Try jsoup</li>
            </ul>
        </div>
    </div>
    <div>jsoup » Cookbook » Cleaning HTML » Sanitize untrusted HTML (to prevent XSS)</div>
    <div>
        <div>
            <div>
                <h1>Sanitize untrusted HTML (to prevent XSS)</h1>
                <h2>Problem</h2>
                <p><a id="0" href="#" name="word">You</a> <a id="1" href="#" name="word">want</a> <a id="2" href="#" name="word">to</a> <a id="3" href="#" name="word">allow</a> <a id="4" href="#" name="word">untrusted</a> <a id="5" href="#" name="word">users</a> <a id="6" href="#" name="word">to</a> <a id="7" href="#" name="word">supply</a> <a id="8" href="#" name="word">HTML</a> <a id="9" href="#" name="word">for</a> <a id="10" href="#" name="word">output</a> <a id="11" href="#" name="word">on</a> <a id="12" href="#" name="word">your</a> <a id="13" href="#" name="word">website</a> <a id="14" href="#" name="word">(e.g.</a> <a id="15" href="#" name="word">as</a> <a id="16" href="#" name="word">comment</a> <a id="17" href="#" name="word">submission).</a> <a id="18" href="#" name="word">You</a> <a id="19" href="#" name="word">need</a> <a id="20" href="#" name="word">to</a> <a id="21" href="#" name="word">clean</a> <a id="22" href="#" name="word">this</a> <a id="23" href="#" name="word">HTML</a> <a id="24" href="#" name="word">to</a> <a id="25" href="#" name="word">avoid</a> <a id="26" href="#" name="word">cross-site</a> <a id="27" href="#" name="word">scripting</a> <a id="28" href="#" name="word">(XSS)</a> <a id="29" href="#" name="word">attacks.</a></p>
                <h2>Solution</h2>
                <p><a id="30" href="#" name="word">Use</a> <a id="31" href="#" name="word">the</a> <a id="32" href="#" name="word">jsoup</a> <a id="33" href="#" name="word">HTML</a> <a id="34" href="#" name="word">Cleaner</a> <a id="35" href="#" name="word">with</a> <a id="36" href="#" name="word">a</a> <a id="37" href="#" name="word">configuration</a> <a id="38" href="#" name="word">specified</a> <a id="39" href="#" name="word">by</a> <a id="40" href="#" name="word">a</a> <a id="41" href="#" name="word">Safelist.</a></p>
                <code><code>String unsafe = "</code></code>
                <p><a href="http://example.com/">Link</a></p>
                <code><code>"; String safe = Jsoup.clean(unsafe, Safelist.basic()); // now:</code></code>
                <p><a href="http://example.com/" rel="nofollow">Link</a></p>
                <code> </code>
                <h2>Discussion</h2>
                <p><a id="42" href="#" name="word">A</a> <a id="43" href="#" name="word">cross-site</a> <a id="44" href="#" name="word">scripting</a> <a id="45" href="#" name="word">attack</a> <a id="46" href="#" name="word">against</a> <a id="47" href="#" name="word">your</a> <a id="48" href="#" name="word">site</a> <a id="49" href="#" name="word">can</a> <a id="50" href="#" name="word">really</a> <a id="51" href="#" name="word">ruin</a> <a id="52" href="#" name="word">your</a> <a id="53" href="#" name="word">day,</a> <a id="54" href="#" name="word">not</a> <a id="55" href="#" name="word">to</a> <a id="56" href="#" name="word">mention</a> <a id="57" href="#" name="word">your</a> <a id="58" href="#" name="word">users'.</a> <a id="59" href="#" name="word">Many</a> <a id="60" href="#" name="word">sites</a> <a id="61" href="#" name="word">avoid</a> <a id="62" href="#" name="word">XSS</a> <a id="63" href="#" name="word">attacks</a> <a id="64" href="#" name="word">by</a> <a id="65" href="#" name="word">not</a> <a id="66" href="#" name="word">allowing</a> <a id="67" href="#" name="word">HTML</a> <a id="68" href="#" name="word">in</a> <a id="69" href="#" name="word">user</a> <a id="70" href="#" name="word">submitted</a> <a id="71" href="#" name="word">content:</a> <a id="72" href="#" name="word">they</a> <a id="73" href="#" name="word">enforce</a> <a id="74" href="#" name="word">plain</a> <a id="75" href="#" name="word">text</a> <a id="76" href="#" name="word">only,</a> <a id="77" href="#" name="word">or</a> <a id="78" href="#" name="word">use</a> <a id="79" href="#" name="word">an</a> <a id="80" href="#" name="word">alternative</a> <a id="81" href="#" name="word">markup</a> <a id="82" href="#" name="word">syntax</a> <a id="83" href="#" name="word">like</a> <a id="84" href="#" name="word">wiki-text</a> <a id="85" href="#" name="word">or</a> <a id="86" href="#" name="word">Markdown.</a> <a id="87" href="#" name="word">These</a> <a id="88" href="#" name="word">are</a> <a id="89" href="#" name="word">seldom</a> <a id="90" href="#" name="word">optimal</a> <a id="91" href="#" name="word">solutions</a> <a id="92" href="#" name="word">for</a> <a id="93" href="#" name="word">the</a> <a id="94" href="#" name="word">user,</a> <a id="95" href="#" name="word">as</a> <a id="96" href="#" name="word">they</a> <a id="97" href="#" name="word">lower</a> <a id="98" href="#" name="word">expressiveness,</a> <a id="99" href="#" name="word">and</a> <a id="100" href="#" name="word">force</a> <a id="101" href="#" name="word">the</a> <a id="102" href="#" name="word">user</a> <a id="103" href="#" name="word">to</a> <a id="104" href="#" name="word">learn</a> <a id="105" href="#" name="word">a</a> <a id="106" href="#" name="word">new</a> <a id="107" href="#" name="word">syntax.</a></p>
                <p><a id="108" href="#" name="word">A</a> <a id="109" href="#" name="word">better</a> <a id="110" href="#" name="word">solution</a> <a id="111" href="#" name="word">may</a> <a id="112" href="#" name="word">be</a> <a id="113" href="#" name="word">to</a> <a id="114" href="#" name="word">use</a> <a id="115" href="#" name="word">a</a> <a id="116" href="#" name="word">rich</a> <a id="117" href="#" name="word">text</a> <a id="118" href="#" name="word">WYSIWYG</a> <a id="119" href="#" name="word">editor</a> <a id="120" href="#" name="word">(like</a> <a id="121" href="#" name="word">CKEditor</a> <a id="122" href="#" name="word">or</a> <a id="123" href="#" name="word">TinyMCE).</a> <a id="124" href="#" name="word">These</a> <a id="125" href="#" name="word">output</a> <a id="126" href="#" name="word">HTML,</a> <a id="127" href="#" name="word">and</a> <a id="128" href="#" name="word">allow</a> <a id="129" href="#" name="word">the</a> <a id="130" href="#" name="word">user</a> <a id="131" href="#" name="word">to</a> <a id="132" href="#" name="word">work</a> <a id="133" href="#" name="word">visually.</a> <a id="134" href="#" name="word">However,</a> <a id="135" href="#" name="word">their</a> <a id="136" href="#" name="word">validation</a> <a id="137" href="#" name="word">is</a> <a id="138" href="#" name="word">done</a> <a id="139" href="#" name="word">on</a> <a id="140" href="#" name="word">the</a> <a id="141" href="#" name="word">client</a> <a id="142" href="#" name="word">side:</a> <a id="143" href="#" name="word">you</a> <a id="144" href="#" name="word">need</a> <a id="145" href="#" name="word">to</a> <a id="146" href="#" name="word">apply</a> <a id="147" href="#" name="word">a</a> <a id="148" href="#" name="word">server-side</a> <a id="149" href="#" name="word">validation</a> <a id="150" href="#" name="word">to</a> <a id="151" href="#" name="word">clean</a> <a id="152" href="#" name="word">up</a> <a id="153" href="#" name="word">the</a> <a id="154" href="#" name="word">input</a> <a id="155" href="#" name="word">and</a> <a id="156" href="#" name="word">ensure</a> <a id="157" href="#" name="word">the</a> <a id="158" href="#" name="word">HTML</a> <a id="159" href="#" name="word">is</a> <a id="160" href="#" name="word">safe</a> <a id="161" href="#" name="word">to</a> <a id="162" href="#" name="word">place</a> <a id="163" href="#" name="word">on</a> <a id="164" href="#" name="word">your</a> <a id="165" href="#" name="word">site.</a> <a id="166" href="#" name="word">Otherwise,</a> <a id="167" href="#" name="word">an</a> <a id="168" href="#" name="word">attacker</a> <a id="169" href="#" name="word">can</a> <a id="170" href="#" name="word">avoid</a> <a id="171" href="#" name="word">the</a> <a id="172" href="#" name="word">client-side</a> <a id="173" href="#" name="word">Javascript</a> <a id="174" href="#" name="word">validation</a> <a id="175" href="#" name="word">and</a> <a id="176" href="#" name="word">inject</a> <a id="177" href="#" name="word">unsafe</a> <a id="178" href="#" name="word">HMTL</a> <a id="179" href="#" name="word">directly</a> <a id="180" href="#" name="word">into</a> <a id="181" href="#" name="word">your</a> <a id="182" href="#" name="word">site</a></p>
                <p><a id="183" href="#" name="word">This</a> <a id="184" href="#" name="word">is</a> <a id="185" href="#" name="word">a</a> <a id="186" href="#" name="word">context</a> <a id="187" href="#" name="word">sentence</a> <a id="188" href="#" name="word">which</a> <a id="189" href="#" name="word">contains</a> <a id="190" href="#" name="word">the</a> <a id="191" href="#" name="word">key</a> <a id="192" href="#" name="word">word</a> <a id="193" href="#" name="word">and</a> <a id="194" href="#" name="word">the</a> <a id="195" href="#" name="word">word</a> <a id="196" href="#" name="word">'key'</a> <a id="197" href="#" name="word">here</a> <a id="198" href="#" name="word">should</a> <a id="199" href="#" name="word">be</a> <a id="200" href="#" name="word">translated</a></p>
                <p><a id="201" href="#" name="word">It</a> <a id="202" href="#" name="word">does</a> <a id="203" href="#" name="word">not</a> <a id="204" href="#" name="word">use</a> <a id="205" href="#" name="word">regular</a> <a id="206" href="#" name="word">expressions,</a> <a id="207" href="#" name="word">which</a> <a id="208" href="#" name="word">are</a> <a id="209" href="#" name="word">inappropriate</a> <a id="210" href="#" name="word">for</a> <a id="211" href="#" name="word">this</a> <a id="212" href="#" name="word">task.</a></p>
                <p><a id="213" href="#" name="word">jsoup</a> <a id="214" href="#" name="word">provides</a> <a id="215" href="#" name="word">a</a> <a id="216" href="#" name="word">range</a> <a id="217" href="#" name="word">of</a> <a id="218" href="#" name="word">Safelist</a> <a id="219" href="#" name="word">configurations</a> <a id="220" href="#" name="word">to</a> <a id="221" href="#" name="word">suit</a> <a id="222" href="#" name="word">most</a> <a id="223" href="#" name="word">requirements;</a> <a id="224" href="#" name="word">they</a> <a id="225" href="#" name="word">can</a> <a id="226" href="#" name="word">be</a> <a id="227" href="#" name="word">modified</a> <a id="228" href="#" name="word">if</a> <a id="229" href="#" name="word">necessary,</a> <a id="230" href="#" name="word">but</a> <a id="231" href="#" name="word">take</a> <a id="232" href="#" name="word">care.</a></p>
                <p><a id="233" href="#" name="word">The</a> <a id="234" href="#" name="word">cleaner</a> <a id="235" href="#" name="word">is</a> <a id="236" href="#" name="word">useful</a> <a id="237" href="#" name="word">not</a> <a id="238" href="#" name="word">only</a> <a id="239" href="#" name="word">for</a> <a id="240" href="#" name="word">avoiding</a> <a id="241" href="#" name="word">XSS,</a> <a id="242" href="#" name="word">but</a> <a id="243" href="#" name="word">also</a> <a id="244" href="#" name="word">in</a> <a id="245" href="#" name="word">limiting</a> <a id="246" href="#" name="word">the</a> <a id="247" href="#" name="word">range</a> <a id="248" href="#" name="word">of</a> <a id="249" href="#" name="word">elements</a> <a id="250" href="#" name="word">the</a> <a id="251" href="#" name="word">user</a> <a id="252" href="#" name="word">can</a> <a id="253" href="#" name="word">provide:</a> <a id="254" href="#" name="word">you</a> <a id="255" href="#" name="word">may</a> <a id="256" href="#" name="word">be</a> <a id="257" href="#" name="word">OK</a> <a id="258" href="#" name="word">with</a> <a id="259" href="#" name="word">textual</a> <a id="260" href="#" name="word">a,</a> <a id="261" href="#" name="word">strong</a> <a id="262" href="#" name="word">elements,</a> <a id="263" href="#" name="word">but</a> <a id="264" href="#" name="word">not</a> <a id="265" href="#" name="word">structural</a> <a id="266" href="#" name="word">div</a> <a id="267" href="#" name="word">or</a> <a id="268" href="#" name="word">table</a> <a id="269" href="#" name="word">elements.</a></p>
                <h2>See also</h2>
                <ul>
                    <li>See the XSS cheat sheet and filter evasion guide, as an example of how regular-expression filters don't work, and why a safe safelist parser-based sanitizer is the correct approach.</li>
                    <li>See the <code>Cleaner</code> reference if you want to get a <code>Document</code> instead of a String return</li>
                    <li>See the <code>Safelist</code> reference for the different canned options, and to create a custom safelist</li>
                    <li>The nofollow link attribute</li>
                </ul>
            </div>
        </div>
        <div>
            <div>
                <h2>Cookbook contents</h2>
                <h3>Introduction</h3>
                <ul>
                    <li>Parsing and traversing a Document</li>
                </ul>
                <h3>Input</h3>
                <ul>
                    <li>Parse a document from a String</li>
                    <li>Parsing a body fragment</li>
                    <li>Load a Document from a URL</li>
                    <li>Load a Document from a File</li>
                </ul>
                <h3>Extracting data</h3>
                <ul>
                    <li>Use DOM methods to navigate a document</li>
                    <li>Use selector-syntax to find elements</li>
                    <li>Extract attributes, text, and HTML from elements</li>
                    <li>Working with URLs</li>
                    <li>Example program: list links</li>
                </ul>
                <h3>Modifying data</h3>
                <ul>
                    <li>Set attribute values</li>
                    <li>Set the HTML of an element</li>
                    <li>Setting the text content of elements</li>
                </ul>
                <h3>Cleaning HTML</h3>
                <ul>
                    <li>Sanitize untrusted HTML (to prevent XSS)</li>
                </ul>
            </div>
        </div>
    </div>
    <div>jsoup HTML parser © 2009 - 2021 Jonathan Hedley</div></div>